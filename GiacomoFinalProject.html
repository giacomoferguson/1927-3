<!DOCTYPE html>
<html>

<head>
    <title>Sing Demo</title>
    <link rel="stylesheet" href="css/main.css">
</head>

<body>
    <div id='container'>
        <div>millivolts: <span id="millivolts">...</span></div>
        <div>
            <button id='sing'>sing</button>
            <textarea id="song" rows="10" cols="50">[65,5],[77,10]</textarea>
        </div>
        <div> <button id='song1'>song1</button></div>
    <script src='js/jquery-3.4.1.min.js'></script>
    <script>
    function playSong1(e) {
        let transpose = 0; //12 brings up 1 octave
        let tempo = 1; //Notes should be at least 4 in duration
        let song1 = [];
        song1.push([79 + transpose, 15 * tempo]);
        song1.push([79 + transpose, 15 * tempo]);
        song1.push([81 + transpose, 30 * tempo]);
        song1.push([79 + transpose, 15 * tempo]);
        song1.push([84 + transpose, 20 * tempo]);
        song1.push([83 + transpose, 20 * tempo]);
        song1.push([0  + transpose, 20 * tempo]);
        song1.push([79 + transpose, 15 * tempo]);
        song1.push([79 + transpose, 15 * tempo]);
        song1.push([81 + transpose, 30 * tempo]);
        song1.push([79 + transpose, 15 * tempo]);
        song1.push([86 + transpose, 20 * tempo]);
        song1.push([84 + transpose, 15 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);
        song1.push([57 + transpose, 5 * tempo]);

        console.log(JSON.stringify(song1));
        fetch('/sing?song=' + JSON.stringify(song1));
    }
    $('#song1').click(playSong1);

    $("#sing").click(function() {
        song = $("#song").val();
        $.post("/sing", JSON.stringify({
            song: song
        }));
    });

$("body").keydown(onKeydown);

function onKeydown(e) {
    console.log(e)
    let letter=e.key.toLowerCase();
        let tempo = 1;
        let pitch = 1;
        song = [];

if(letter=="a"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
}
      
if(letter=="b"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="c"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="d"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="e"){
    song.push([69*pitch, 10*tempo]);
}

if(letter=="f"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="g"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="h"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="i"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="j"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="k"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="l"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="m"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="n"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="o"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="p"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="q"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="r"){
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="s"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="t"){
    song.push([69*pitch, 30*tempo]);
}

if(letter=="u"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="v"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="w"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="x"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="y"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="z"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="1"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="2"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="3"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="4"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 30*tempo]);
}

if(letter=="5"){
    song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="6"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="7"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="8"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="9"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 10*tempo]);
}

if(letter=="0"){
    song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
        song.push([69*pitch, 30*tempo]);
}
console.log(song);
        fetch('/sing?song=' + JSON.stringify(song));
}
    var latestData = {};

    function readSensors() {
        fetch('/sensors')
            .then((resp) => resp.json())
            .then(function(data) {
                latestData = data;
                // console.log(latestData)
                $('#millivolts').text(latestData.voltage);
            })
    }
    setInterval(readSensors, 2000);
    </script>
</body>

</html>